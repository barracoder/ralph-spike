# Ralph Progress Log
Started: Thu 15 Jan 2026 23:59:33 GMT
---

## Codebase Patterns
- prd.json must be an object with `branchName` at root, not a plain array
- prd.json lives in `scripts/ralph/prd.json`
- Use DotNetObjectReference + [JSInvokable] for JS-to-C# callbacks in Blazor
- Implement IAsyncDisposable to clean up JS interop resources

---

## 2026-01-16T00:01 - Story 1
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented comprehensive README with project overview, install instructions, and Ralph quickstart
- Files changed: README.md, scripts/ralph/prd.json (fixed structure)
- **Learnings for future iterations:**
  - PRD was initially a plain array - fixed to object with `branchName` at root per AGENTS.md gotcha
  - Current branch is `inital-setup` (note typo in branch name)
---

## 2026-01-16T00:23 - Story 1
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created Blazor WebAssembly project with .NET 8 in src/SpaceInvaders
- Added Blazor.Extensions.Canvas package (version 1.1.1)
- Verified build and run work (dev server on localhost:5041)
- **Learnings for future iterations:**
  - Use `dotnet new blazorwasm -n NAME -f net8.0 -o OUTPUT --no-https` for simple wasm project
  - Clean obj/bin before build if getting weird MSBuild errors
  - Port is configured in Properties/launchSettings.json (5041 by default)
---

## 2026-01-16T00:25 - Story 2
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created GameCanvas.razor with 800x600 HTML5 canvas using Blazor.Extensions.Canvas
- Renders black background color with green border
- Added canvas JS interop script to index.html
- Updated Home.razor to display GameCanvas component
- Files changed: Components/GameCanvas.razor, Components/GameCanvas.razor.css, Pages/Home.razor, _Imports.razor, wwwroot/index.html
- **Learnings for future iterations:**
  - Blazor.Extensions.Canvas requires adding `_content/Blazor.Extensions.Canvas/blazor.extensions.canvas.js` to index.html
  - Use BECanvas component with Width/Height props, then CreateCanvas2DAsync() for 2D context
  - Components directory needs to be created manually and added to _Imports.razor
---

## 2026-01-16T00:27 - Story 3
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented requestAnimationFrame game loop via JS interop
- Created wwwroot/js/gameLoop.js with start/stop/tick functions
- Updated GameCanvas.razor with JSRuntime injection, DotNetObjectReference, and IAsyncDisposable
- Canvas clears and redraws each frame at ~60fps
- Files changed: Components/GameCanvas.razor, wwwroot/index.html, wwwroot/js/gameLoop.js
- **Learnings for future iterations:**
  - Use DotNetObjectReference<T> to pass C# instance to JS for callbacks
  - Mark callback methods with [JSInvokable] attribute
  - Implement IAsyncDisposable to clean up JS resources and prevent memory leaks
  - requestAnimationFrame returns an ID needed for cancelAnimationFrame
---
